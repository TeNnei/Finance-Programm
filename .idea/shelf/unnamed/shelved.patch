Index: src/sample/ProgramIn.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package sample;\r\n\r\nimport javafx.fxml.FXML;\r\nimport javafx.scene.control.Button;\r\nimport javafx.scene.control.DatePicker;\r\nimport javafx.scene.control.TextField;\r\n\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport java.text.ParseException;\r\nimport java.sql.Date;\r\n\r\n\r\npublic class ProgramIn {\r\n    @FXML private TextField contract_number;\r\n    @FXML private TextField debit;\r\n    @FXML private TextField kredit;\r\n    @FXML private TextField comments;\r\n    @FXML private TextField som;\r\n    @FXML private Button contin;\r\n    @FXML private TextField contract;\r\n    @FXML private DatePicker date;\r\n    @FXML private TextField usd;\r\n\r\n    @FXML\r\n    void initialize (){\r\n        contin.setOnAction(actionEvent -> {\r\n            int codeIn = Integer.parseInt(debit.getText());\r\n            checkCodeIn(codeIn);\r\n\r\n            try {\r\n                registOperation();\r\n\r\n            } catch (ParseException e) {\r\n                e.printStackTrace();\r\n            }\r\n\r\n\r\n            updateConsolidInf();\r\n            updateConsolidInf1();\r\n            updateConsoliddebit();\r\n            updateConsolidkredit();\r\n        });\r\n\r\n    }\r\n    public void registOperation () throws ParseException {\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        String contract_number1 = contract_number.getText();\r\n        String contract1 = contract.getText();\r\n        int debit1 = Integer.parseInt(debit.getText());\r\n        int credit1 = Integer.parseInt(kredit.getText());\r\n        Date date1 = Date.valueOf(date.getValue());\r\n        String comment = comments.getText();\r\n        int som1 = Integer.parseInt(som.getText());\r\n        int usd1 = Integer.parseInt(usd.getText());\r\n        ProgramData inf = new ProgramData(contract_number1, contract1, debit1, credit1, date1, comment, som1, usd1);\r\n        db.writeInProgram(inf);\r\n    }\r\n    public void registConsolidatedInf(){\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        int code1 = Integer.parseInt(debit.getText());\r\n        String category1 = \" \";\r\n        String adittional_score1 = \" \";\r\n        String name_of_score1 = \" \";\r\n        int debit1 = 0;\r\n        int saldo_in_som1 = 0;\r\n        int kredit1 = 0;\r\n        int saldo_out_som1 = 0;\r\n        int difference1 = 0;\r\n        int debit_usd1 = 0;\r\n        int saldo_in_usd1 = 0;\r\n        int kredit_usd1 = 0;\r\n        int saldo_out_usd1 = 0;\r\n        int difference_usd1 = 0;\r\n        ConsolidInfin input = new ConsolidInfin(code1, category1, adittional_score1, name_of_score1, debit1,\r\n                saldo_in_som1, kredit1, saldo_out_som1, difference1, debit_usd1, saldo_in_usd1, kredit_usd1, saldo_out_usd1, difference_usd1);\r\n        db.writeInProgram2(input);\r\n    }\r\n    public void checkCodeIn (int code){\r\n        DatabaseHandler read = new DatabaseHandler();\r\n        ConsolidInfin pr = new ConsolidInfin();\r\n        pr.setCode(code);\r\n        ResultSet first = read.checkCode(pr);\r\n        int fg = 0;\r\n        try {\r\n            while (first.next()) {\r\n                fg++;\r\n            }\r\n        } catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n        if(fg >= 1)\r\n        {\r\n            System.out.println(\"Success!\");\r\n        }\r\n        else{\r\n            registConsolidatedInf();\r\n        }\r\n    }\r\n\r\n    public void updateConsolidInf(){\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        int debit2 = Integer.parseInt(debit.getText());\r\n        ConsolidInfin inf = new ConsolidInfin(debit2);\r\n        db.consolidUpdate(inf);\r\n    }\r\n\r\n    public void updateConsolidInf1(){\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        int debit2 = Integer.parseInt(kredit.getText());\r\n        ConsolidInfin inf = new ConsolidInfin(debit2);\r\n        db.consolidUpdate(inf);\r\n    }\r\n\r\n    public void updateConsoliddebit(){\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        int debit2 = Integer.parseInt(debit.getText());\r\n        ConsolidInfin inf = new ConsolidInfin(debit2);\r\n        db.consolidUpdatedebit(inf);\r\n    }\r\n\r\n    public void updateConsolidkredit(){\r\n        DatabaseHandler db = new DatabaseHandler();\r\n        int debit2 = Integer.parseInt(kredit.getText());\r\n        ConsolidInfin inf = new ConsolidInfin(debit2);\r\n        db.consolidUpdatekredit(inf);\r\n    }\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/sample/ProgramIn.java b/src/sample/ProgramIn.java
--- a/src/sample/ProgramIn.java	(revision d662110702dfbdfe3fd4d618d8c55dfd50f60ec8)
+++ b/src/sample/ProgramIn.java	(date 1615967005665)
@@ -25,9 +25,6 @@
     @FXML
     void initialize (){
         contin.setOnAction(actionEvent -> {
-            int codeIn = Integer.parseInt(debit.getText());
-            checkCodeIn(codeIn);
-
             try {
                 registOperation();
 
@@ -35,6 +32,10 @@
                 e.printStackTrace();
             }
 
+            int codeIn = Integer.parseInt(debit.getText());
+            checkCodeIn(codeIn);
+
+
 
             updateConsolidInf();
             updateConsolidInf1();
Index: src/sample/DatabaseHandler.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package sample;\r\n\r\nimport java.util.Date;\r\nimport java.sql.*;\r\n\r\npublic class DatabaseHandler {\r\n    static final String DB_URL = \"jdbc:postgresql://127.0.0.1:5432/postgres\";\r\n    static final String USER = \"postgres\";\r\n    static final String PASS = \"987346521\";\r\n\r\n    public static Connection getDbConnection() {\r\n\r\n        try {\r\n            Class.forName(\"org.postgresql.Driver\");\r\n        } catch (ClassNotFoundException e) {\r\n            System.out.println(\"Ошибка нет драйвера\");\r\n            e.printStackTrace();\r\n        }\r\n        System.out.println(\"Драйвер найден\");\r\n        Connection connection = null;\r\n        try {\r\n            connection = DriverManager\r\n                    .getConnection(DB_URL, USER, PASS);\r\n        } catch (SQLException e) {\r\n            System.out.println(\"Ошибка\");\r\n            e.printStackTrace();\r\n        }\r\n        if (connection != null) {\r\n            System.out.println(\"Бзаданных подключена\");\r\n        } else {\r\n            System.out.println(\"Ошибка\");\r\n        }\r\n        return   connection;\r\n    }\r\n\r\n//    public void writerUser(User org){\r\n//            String insert = \"INSERT INTO \" + Constant.TABLE_OF_ORGANIZATION + \"(\" + Constant.NAME_OF_ORGANIZATIONS\r\n//                    + \",\" + Constant.MONEY_OF_ORGANIZATION + \",\" + Constant.VMONEY_OF_ORGANIZATION +\")\" + \"VALUES(?,?,?)\";\r\n//        try {\r\n//            PreparedStatement prst = getDbConnection().prepareStatement(insert);\r\n//            prst.setString(1, org.getOrganization());\r\n//            prst.setInt(2, org.getMoney());\r\n//            prst.setInt(3, org.getVmoney());\r\n//            prst.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//    }\r\n//\r\n//   public ResultSet getInformation (User auth){\r\n//  ResultSet resultSet = null;\r\n//  String select = \"SELECT * FROM \" + Constant.TABLE_OF_ORGANIZATION + \" WHERE \"\r\n//     + Constant.NAME_OF_ORGANIZATIONS + \"=?\";\r\n//       try {\r\n//           PreparedStatement prst0 = getDbConnection().prepareStatement(select);\r\n//           prst0.setString(1, auth.getOrganization());\r\n//\r\n//          resultSet = prst0.executeQuery();\r\n//       } catch (SQLException throwables) {\r\n//           throwables.printStackTrace();\r\n//       }\r\n//       return resultSet;\r\n//   }\r\n//\r\n//    public ResultSet setInformation (User auth1){\r\n//        ResultSet resultSet = null;\r\n//        String select1 = \"UPDATE \" + Constant.TABLE_OF_ORGANIZATION + \" SET \" + Constant.MONEY_OF_ORGANIZATION + \" = \" + Constant.MONEY_OF_ORGANIZATION + \" - ?\" + \" WHERE \" + Constant.NAME_OF_ORGANIZATIONS + \" =?;\";\r\n//        try {\r\n//            PreparedStatement prst0 = getDbConnection().prepareStatement(select1);\r\n//            prst0.setString(2, auth1.getOrganization());\r\n//            prst0.setInt(1, auth1.getMoney());\r\n//\r\n//           prst0.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//        return resultSet;\r\n//    }\r\n//    public ResultSet setInformation1 (User auth2){\r\n//        ResultSet resultSet = null;\r\n//        String select1 = \"UPDATE \" + Constant.TABLE_OF_ORGANIZATION + \" SET \" + Constant.MONEY_OF_ORGANIZATION + \" = \" + Constant.MONEY_OF_ORGANIZATION + \" + ?\" + \" WHERE \" + Constant.NAME_OF_ORGANIZATIONS + \" =?;\";\r\n//        try {\r\n//            PreparedStatement prst0 = getDbConnection().prepareStatement(select1);\r\n//            prst0.setString(2, auth2.getOrganization());\r\n//            prst0.setInt(1, auth2.getMoney());\r\n//            prst0.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//        return resultSet;\r\n//    }\r\n//    public ResultSet DeleteInformation (User auth1){\r\n//        ResultSet resultSet = null;\r\n//        String select1 = \"DELETE FROM \" + Constant.TABLE_OF_ORGANIZATION + \" WHERE \"  + Constant.NAME_OF_ORGANIZATIONS + \" =?;\";\r\n//        try {\r\n//            PreparedStatement prst0 = getDbConnection().prepareStatement(select1);\r\n//            prst0.setString(1, auth1.getOrganization());\r\n//            prst0.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//        return resultSet;\r\n//    }\r\n//    public ResultSet setInformation2 (User auth1){\r\n//        ResultSet resultSet = null;\r\n//        String select1 = \"UPDATE \" + Constant.TABLE_OF_ORGANIZATION + \" SET \" + Constant.VMONEY_OF_ORGANIZATION + \" = \" + Constant.VMONEY_OF_ORGANIZATION + \" - ?\" + \" WHERE \" + Constant.NAME_OF_ORGANIZATIONS + \" =?;\";\r\n//        try {\r\n//            PreparedStatement prst0 = getDbConnection().prepareStatement(select1);\r\n//            prst0.setString(2, auth1.getOrganization());\r\n//            prst0.setInt(1, auth1.getMoney());\r\n//\r\n//            prst0.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//        return resultSet;\r\n//    }\r\n//    public ResultSet setInformation3 (User auth2){\r\n//        ResultSet resultSet = null;\r\n//        String select1 = \"UPDATE \" + Constant.TABLE_OF_ORGANIZATION + \" SET \" + Constant.VMONEY_OF_ORGANIZATION + \" = \" + Constant.VMONEY_OF_ORGANIZATION + \" + ?\" + \" WHERE \" + Constant.NAME_OF_ORGANIZATIONS + \" =?;\";\r\n//        try {\r\n//            PreparedStatement prst0 = getDbConnection().prepareStatement(select1);\r\n//            prst0.setString(2, auth2.getOrganization());\r\n//            prst0.setInt(1, auth2.getMoney());\r\n//\r\n//            prst0.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//        return resultSet;\r\n//    }\r\n//\r\n//    public void WriteOperation(User2 org1){\r\n//        String insert = \"INSERT INTO \" + Constant2.TABLE_OF_ORGANIZATION + \"(\" + Constant2.FROM_WHOM\r\n//                + \",\" + Constant2.TO_WHOM + \",\" + Constant2.AMOUNT_OF_TRANSACTION + \",\" + Constant2.COMMENTS+ \",\" + Constant2.DATE_OF_TRANSACTION +\")\" + \" VALUES(?,?,?,?,?)\";\r\n//        try {\r\n//            PreparedStatement prst = getDbConnection().prepareStatement(insert);\r\n//            prst.setString(1, org1.getFromWhom());\r\n//            prst.setString(2, org1.getToWhom());\r\n//            prst.setString(3, org1.getAmount());\r\n//            prst.setString(4, org1.getComments());\r\n//            Date utilDate = new Date();\r\n//            java.sql.Date date = new java.sql.Date(utilDate.getTime());\r\n//            prst.setDate(5, date);\r\n//            prst.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//    }\r\n//\r\n//    public void RegistUser (User3 user){\r\n//        String insert = \"INSERT INTO \" + Constant3.TABLE_OF_USER + \"(\" + Constant3.USER_NAME\r\n//                + \",\" + Constant3.SECOND_USER_NAME + \",\" + Constant3.LOGIN + \",\" + Constant3.PASSWORD + \",\" + Constant3.PASSPORT_NUMBER +\")\" + \"VALUES(?,?,?,?,?)\";\r\n//        try {\r\n//            PreparedStatement prst = getDbConnection().prepareStatement(insert);\r\n//            prst.setString(1, user.userName());\r\n//            prst.setString(2, user.secondName());\r\n//            prst.setString(3, user.Loginin());\r\n//            prst.setString(4, user.password());\r\n//            prst.setInt(5, user.getPassportNumber());\r\n//            prst.executeUpdate();\r\n//        } catch (SQLException throwables) {\r\n//            throwables.printStackTrace();\r\n//        }\r\n//    }\r\n//\r\n\r\n        public ResultSet checkCode(ConsolidInfin auth) {\r\n        ResultSet resultSet = null;\r\n        String select = \"SELECT * FROM \" + ConsolidInf.TABLE_OF_SUMMARY + \" WHERE \"\r\n                + ConsolidInf.CODE + \"=?\";\r\n        try {\r\n            PreparedStatement prst0 = getDbConnection().prepareStatement(select);\r\n            prst0.setInt( 1, auth.getCode());\r\n            resultSet = prst0.executeQuery();\r\n        } catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n        return resultSet;\r\n    }\r\n\r\n    public void writeInProgram(ProgramData org){\r\n        String insert = \"INSERT INTO \" + MainInf.TABLE_OF_INF + \"(\" + MainInf.CONTRACT_NUMBER\r\n                + \", \" + MainInf.CONTRACT + \", \" + MainInf.DEBIT + \", \" + MainInf.KREDIT + \", \" + MainInf.DATE + \", \" + MainInf.COMMENTS + \", \" + MainInf.SOM + \", \" + MainInf.USD +\")\" + \"VALUES(?,?,?,?,?,?,?,?)\";\r\n        try {\r\n            PreparedStatement prst = getDbConnection().prepareStatement(insert);\r\n            prst.setString(1, org.getContract_number());\r\n            prst.setString(2, org.getContract());\r\n            prst.setInt(3, org.getDebit());\r\n            prst.setInt(4, org.getKredit());\r\n            prst.setDate(5, org.getDate());\r\n            prst.setString(6, org.getComments());\r\n            prst.setInt(7, org.getSom());\r\n            prst.setInt(8, org.getUsd());\r\n            prst.executeUpdate();\r\n        } catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public void writeInProgram2(ConsolidInfin org){\r\n        String insert = \"INSERT INTO \" + ConsolidInf.TABLE_OF_SUMMARY + \"(\" + ConsolidInf.CODE\r\n                + \", \" + ConsolidInf.ADDITIONAL_SCORE + \", \" + ConsolidInf.CATEGORY + \",\" + ConsolidInf.NAME_SCORE + \", \"  + ConsolidInf.SALDO_IN_SOM\r\n                + \", \" + ConsolidInf.DEBET + \", \" + ConsolidInf.KREDIT + \", \" + ConsolidInf.SALDO_OUT_SOM + \", \" + ConsolidInf.DIFFERENCE + \",\" + ConsolidInf.SALDO_IN_USD\r\n                + \", \" + ConsolidInf.DEBET_USD + \", \" + ConsolidInf.KREDIT_USD + \", \" + ConsolidInf.SALDO_OUT_USD + \",\" + ConsolidInf.DIFFERENCE_USD +\")\" + \"VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?)\";\r\n        try {\r\n            PreparedStatement prst = getDbConnection().prepareStatement(insert);\r\n            prst.setInt(1, org.getCode());\r\n            prst.setString(2, org.getAdittional_score());\r\n            prst.setString(3, org.getCategory());\r\n            prst.setString(4, org.getName_of_score());\r\n            prst.setInt(5, org.getSaldo_in_som());\r\n            prst.setInt(6, org.getDebit());\r\n            prst.setInt(7, org.getKredit());\r\n            prst.setInt(8, org.getSaldo_out_som());\r\n            prst.setInt(9, org.getDifference());\r\n            prst.setInt(10, org.getSaldo_in_usd());\r\n            prst.setInt(11, org.getDebit_usd());\r\n            prst.setInt(12, org.getKredit_usd());\r\n            prst.setInt(13, org.getSaldo_out_usd());\r\n            prst.setInt(14, org.getDifference_usd());\r\n            prst.executeUpdate();\r\n        } catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n    }\r\n    public void  consolidUpdate (ConsolidInfin auth1) {\r\n        String update = \"UPDATE \" + ConsolidInf.TABLE_OF_SUMMARY +  \" SET \" + ConsolidInf.SALDO_IN_SOM + \" = (SELECT SUM (som) FROM maininf WHERE \"\r\n                + MainInf.DEBIT + \" =?\" + \")\" + \" - (SELECT SUM(som) FROM maininf WHERE \" + MainInf.KREDIT +\" = ?\" + \")\" + \" WHERE \" + ConsolidInf.CODE + \" = ?\";\r\n        try {\r\n            PreparedStatement prepere = getDbConnection().prepareStatement(update);\r\n            prepere.setInt(1, auth1.getDebit());\r\n            prepere.setInt(2, auth1.getDebit());\r\n            prepere.setInt(3, auth1.getDebit());\r\n            prepere.executeUpdate();\r\n        }catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n    }\r\n    public void  consolidUpdatedebit (ConsolidInfin auth1) {\r\n        String update = \"UPDATE \" + ConsolidInf.TABLE_OF_SUMMARY +  \" SET \" + ConsolidInf.DEBET + \" = (SELECT SUM (som) FROM maininf WHERE \"\r\n                + MainInf.DEBIT + \" =?)\" + \" WHERE \" + ConsolidInf.CODE +\" =?\";\r\n        try {\r\n            PreparedStatement prepere = getDbConnection().prepareStatement(update);\r\n            prepere.setInt(1, auth1.getDebit());\r\n            prepere.setInt(2, auth1.getDebit());\r\n            prepere.executeUpdate();\r\n        }catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n    }\r\n    public void  consolidUpdatekredit (ConsolidInfin auth1) {\r\n        String update = \"UPDATE \" + ConsolidInf.TABLE_OF_SUMMARY +  \" SET \" + ConsolidInf.KREDIT + \" = (SELECT SUM (som) FROM maininf WHERE \"\r\n                + MainInf.KREDIT + \" =?)\" + \" WHERE \" + ConsolidInf.CODE +\" =?\";\r\n        try {\r\n            PreparedStatement prepere = getDbConnection().prepareStatement(update);\r\n            prepere.setInt(1, auth1.getDebit());\r\n            prepere.setInt(2, auth1.getDebit());\r\n            prepere.executeUpdate();\r\n        }catch (SQLException throwables) {\r\n            throwables.printStackTrace();\r\n        }\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/sample/DatabaseHandler.java b/src/sample/DatabaseHandler.java
--- a/src/sample/DatabaseHandler.java	(revision d662110702dfbdfe3fd4d618d8c55dfd50f60ec8)
+++ b/src/sample/DatabaseHandler.java	(date 1615967712068)
@@ -261,4 +261,18 @@
             throwables.printStackTrace();
         }
     }
+    public void consolidUpdateOut (ConsolidInfin auth2){
+        String updateOut = "UPDATE summary SET saldo_out_som = (SELECT saldo_in_som FROM summary WHERE " + ConsolidInf.CODE + " =?) + ((SELECT debet FROM summary WHERE " + ConsolidInf.CODE + " =?) - (SELECT kredit FROM summary WHERE " + ConsolidInf.CODE + " =?))" + " WHERE " + ConsolidInf.CODE + " =?";
+        try {
+            PreparedStatement prepare = getDbConnection().prepareStatement(updateOut);
+            prepare.setInt(1, auth2.getDebit());
+            prepare.setInt(2, auth2.getDebit());
+            prepare.setInt (3, auth2.getDebit());
+            prepare.setInt(4, auth2.getDebit());
+            prepare.executeUpdate();
+        }
+    catch (SQLException throwables) {
+        throwables.printStackTrace();
+    }
+    }
 }
